const ATOMIC_STDIN_FILLED = 0;
const ATOMIC_STDIN_CONSUMED = 1;
const ATOMIC_COUNT = 2;
const STDIN_BITS = 10;
const STDIN_COUNT = (1 << STDIN_BITS);
const STDIN_MASK = STDIN_COUNT - 1;
function exec_base64_wasm(data, wasm) {
    var memory;
    const { atomic_sab, stdin_sab } = data;
    const atomic = new Int32Array(atomic_sab);
    const stdin = new Uint8Array(stdin_sab);
    const ERRNO_SUCCESS = 0;
    const ERRNO_BADF = 8;
    const ERRNO_NOTCAPABLE = 76;
    function read_u8(ptr, offset) { return new DataView(memory.buffer).getUint8(ptr + offset); }
    function read_u16(ptr, offset) { return new DataView(memory.buffer).getUint16(ptr + offset, true); }
    function read_u32(ptr, offset) { return new DataView(memory.buffer).getUint32(ptr + offset, true); }
    function read_usize(ptr, offset) { return read_u32(ptr, offset); }
    function read_ptr(ptr, offset) { return read_usize(ptr, offset); }
    function write_u8(ptr, offset, value) { new DataView(memory.buffer).setUint8(ptr + offset, value); }
    function write_u16(ptr, offset, value) { new DataView(memory.buffer).setUint16(ptr + offset, value, true); }
    function write_u32(ptr, offset, value) { new DataView(memory.buffer).setUint32(ptr + offset, value, true); }
    function write_usize(ptr, offset, value) { write_u32(ptr, offset, value); }
    function write_ptr(ptr, offset, value) { write_usize(ptr, offset, value); }
    function slice(ptr, start, end) { return new DataView(memory.buffer, ptr + start, end - start); }
    function nyi() {
        return ERRNO_NOTCAPABLE;
    }
    function args_get() { return nyi(); }
    function args_sizes_get() { return nyi(); }
    function environ_get() { return nyi(); }
    function environ_sizes_get() { return nyi(); }
    function clock_res_get() { return nyi(); }
    function clock_time_get() { return nyi(); }
    function fd_advise() { return nyi(); }
    function fd_allocate() { return nyi(); }
    function fd_close() { return nyi(); }
    function fd_datasync() { return nyi(); }
    function fd_fdstat_get() { return nyi(); }
    function fd_fdstat_set_flags() { return nyi(); }
    function fd_fdstat_set_rights() { return nyi(); }
    function fd_filestat_get() { return nyi(); }
    function fd_filestat_set_size() { return nyi(); }
    function fd_filestat_set_times() { return nyi(); }
    function fd_pread() { return nyi(); }
    function fd_prestat_get() { return nyi(); }
    function fd_prestat_dir_name() { return nyi(); }
    function fd_pwrite() { return nyi(); }
    function fd_read(fd, iovec_array_ptr, iovec_array_len, nread_ptr) {
        var nread = 0;
        var errno = ERRNO_SUCCESS;
        for (var iovec_idx = 0; iovec_idx < iovec_array_len; ++iovec_idx) {
            var buf_ptr = read_ptr(iovec_array_ptr, 8 * iovec_idx + 0);
            var buf_len = read_usize(iovec_array_ptr, 8 * iovec_idx + 4);
            if (buf_len <= 0) {
                continue;
            }
            switch (fd) {
                case 0:
                    for (;;) {
                        var consumed = Atomics.load(atomic, ATOMIC_STDIN_CONSUMED);
                        while (Atomics.wait(atomic, ATOMIC_STDIN_FILLED, consumed) !== "ok") { }
                        var filled = Atomics.load(atomic, ATOMIC_STDIN_FILLED);
                        var available = (filled - consumed) | 0;
                        console.assert(available > 0);
                        var n = Math.min(available, buf_len);
                        for (var i = 0; i < n; ++i) {
                            var b = stdin[(i + consumed) & STDIN_MASK];
                            work2dom.post({ kind: "console", text: new TextDecoder().decode(new Uint8Array([b])) });
                            write_u8(buf_ptr, i, b);
                        }
                        Atomics.store(atomic, ATOMIC_STDIN_CONSUMED, (consumed + n) | 0);
                        nread += n;
                        break;
                    }
                    break;
                default:
                    errno = ERRNO_BADF;
                    break;
            }
        }
        write_usize(nread_ptr, 0, nread);
        return errno;
    }
    function fd_readdir() { return nyi(); }
    function fd_renumber() { return nyi(); }
    function fd_seek() { return nyi(); }
    function fd_sync() { return nyi(); }
    function fd_tell() { return nyi(); }
    function fd_write(fd, ciovec_array_ptr, ciovec_array_len, nwritten_ptr) {
        var nwritten = 0;
        var errno = ERRNO_SUCCESS;
        var text = "";
        for (var ciovec_idx = 0; ciovec_idx < ciovec_array_len; ++ciovec_idx) {
            var buf_ptr = read_ptr(ciovec_array_ptr, 8 * ciovec_idx + 0);
            var buf_len = read_usize(ciovec_array_ptr, 8 * ciovec_idx + 4);
            switch (fd) {
                case 1:
                case 2:
                    text += new TextDecoder().decode(slice(buf_ptr, 0, buf_len));
                    nwritten += buf_len;
                    break;
                default:
                    errno = ERRNO_BADF;
                    break;
            }
        }
        if (text !== "") {
            work2dom.post({ kind: "console", text });
        }
        write_usize(nwritten_ptr, 0, nwritten);
        return errno;
    }
    function path_create_directory() { return nyi(); }
    function path_filestats_get() { return nyi(); }
    function path_filestat_set_times() { return nyi(); }
    function path_link() { return nyi(); }
    function path_open() { return nyi(); }
    function path_readlink() { return nyi(); }
    function path_remove_directory() { return nyi(); }
    function path_rename() { return nyi(); }
    function path_symlink() { return nyi(); }
    function path_unlink_file() { return nyi(); }
    function poll_oneoff() { return nyi(); }
    function proc_exit(code) {
        work2dom.post({ kind: "proc_exit", code });
        throw "exit";
    }
    function proc_raise() { return nyi(); }
    function sched_yield() { return nyi(); }
    function random_get() { return nyi(); }
    function sock_recv() { return nyi(); }
    function sock_send() { return nyi(); }
    function sock_shutdown() { return nyi(); }
    const imports = {
        wasi_snapshot_preview1: {
            args_get,
            args_sizes_get,
            environ_get,
            environ_sizes_get,
            clock_res_get,
            clock_time_get,
            fd_advise,
            fd_allocate,
            fd_close,
            fd_datasync,
            fd_fdstat_get,
            fd_fdstat_set_flags,
            fd_fdstat_set_rights,
            fd_filestat_get,
            fd_filestat_set_size,
            fd_filestat_set_times,
            fd_pread,
            fd_prestat_get,
            fd_prestat_dir_name,
            fd_pwrite,
            fd_read,
            fd_readdir,
            fd_renumber,
            fd_seek,
            fd_sync,
            fd_tell,
            fd_write,
            path_create_directory,
            path_filestats_get,
            path_filestat_set_times,
            path_link,
            path_open,
            path_readlink,
            path_remove_directory,
            path_rename,
            path_symlink,
            path_unlink_file,
            poll_oneoff,
            proc_exit,
            proc_raise,
            sched_yield,
            random_get,
            sock_recv,
            sock_send,
            sock_shutdown,
        },
    };
    const binary = atob(wasm);
    const typedarray = new Uint8Array(binary.length);
    for (var i = 0; i < binary.length; ++i) {
        typedarray[i] = binary.charCodeAt(i);
    }
    WebAssembly.compile(typedarray).then(function (m) {
        if (false) {
            WebAssembly.Module.imports(m).forEach(function (imp) {
                console.log("import", imp);
            });
            WebAssembly.Module.exports(m).forEach(function (exp) {
                console.log("export", exp);
            });
        }
        return WebAssembly.instantiate(m, imports);
    }).then(function (m) {
        memory = m.exports.memory;
        try {
            m.exports.main();
            proc_exit(0);
        }
        catch (e) {
            if (e !== "exit") {
                console.error(e);
                debugger;
                throw e;
            }
        }
        finally {
            self.close();
        }
    });
}
var main_dom_worker;
function main_dom() {
    const con = requireElementById("console");
    const cursor = requireElementById("cursor");
    const atomic_sab = new SharedArrayBuffer(4 * ATOMIC_COUNT);
    const atomic = new Int32Array(atomic_sab);
    const stdin_sab = new SharedArrayBuffer(STDIN_COUNT);
    const stdin = new Uint8Array(stdin_sab);
    const blob = new Blob(Array.prototype.map.call(document.querySelectorAll('script:not([data-js-worker=\'false\'])'), function (oScript) { return oScript.textContent; }), { type: 'text/javascript' });
    main_dom_worker = new Worker(window.URL.createObjectURL(blob));
    main_dom_worker.onmessage = function (e) {
        switch (e.data.kind) {
            case "console":
                con.insertBefore(document.createTextNode(e.data.text), cursor);
                break;
            case "proc_exit":
                var exit = document.createElement("span");
                exit.textContent = `\nprocess exited with code ${e.data.code}`;
                exit.style.color = "#888";
                con.insertBefore(exit, cursor);
                con.removeChild(cursor);
                break;
            default:
                console.error("unexpected event kind", e.data.kind);
                debugger;
                break;
        }
    };
    dom2work.post({
        kind: "init",
        atomic_sab,
        stdin_sab,
    });
    var stdin_buffer = [];
    document.addEventListener("keypress", function (e) {
        var text = e.char || String.fromCharCode(e.charCode);
        if (text === "\r") {
            text = "\n";
        }
        var chars = new TextEncoder().encode(text);
        for (var i = 0; i < chars.length; ++i) {
            stdin_buffer.push(chars[i]);
        }
    });
    setInterval(function () {
        if (stdin_buffer.length === 0)
            return;
        var filled = Atomics.load(atomic, ATOMIC_STDIN_FILLED);
        var consumed = Atomics.load(atomic, ATOMIC_STDIN_CONSUMED);
        var available = STDIN_COUNT - ((filled - consumed) | 0);
        var n = Math.min(available, stdin_buffer.length);
        for (var i = 0; i < n; ++i) {
            stdin[(i + filled) & STDIN_MASK] = stdin_buffer[i];
        }
        stdin_buffer.splice(0, n);
        filled = (filled + n) | 0;
        Atomics.store(atomic, ATOMIC_STDIN_FILLED, filled);
        Atomics.notify(atomic, ATOMIC_STDIN_FILLED, +Infinity);
    }, 0);
}
function requireElementById(id) {
    let el = document.getElementById(id);
    if (!el) {
        throw `no such element in document: #${id}`;
    }
    return el;
}
function main_worker() {
    self.onmessage = function (e) {
        switch (e.data.kind) {
            case "init":
                exec_base64_wasm(e.data, "{BASE64_WASM32}");
                break;
            default:
                console.error("unexpected event kind", e.data.kind);
                debugger;
                break;
        }
    };
}
var dom2work;
(function (dom2work) {
    function post(data) {
        main_dom_worker.postMessage(data);
    }
    dom2work.post = post;
})(dom2work || (dom2work = {}));
var work2dom;
(function (work2dom) {
    function post(message) {
        self.postMessage(message);
    }
    work2dom.post = post;
})(work2dom || (work2dom = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc2NyaXB0L2NvbnN0YW50cy50cyIsIi4uL3NjcmlwdC9leGVjLXdhc20udHMiLCIuLi9zY3JpcHQvbWFpbi1kb20udHMiLCIuLi9zY3JpcHQvbWFpbi13b3JrZXIudHMiLCIuLi9zY3JpcHQvbWVzc2FnZXMvZG9tMndvcmsudHMiLCIuLi9zY3JpcHQvbWVzc2FnZXMvd29yazJkb20udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxtQkFBbUIsR0FBSyxDQUFDLENBQUM7QUFDaEMsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLENBQUM7QUFDaEMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxDQUFDO0FBRXZCLE1BQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztBQUN0QixNQUFNLFdBQVcsR0FBRyxDQUFDLENBQUMsSUFBSSxVQUFVLENBQUMsQ0FBQztBQUN0QyxNQUFNLFVBQVUsR0FBRyxXQUFXLEdBQUMsQ0FBQyxDQUFDO0FDTmpDLFNBQVMsZ0JBQWdCLENBQUMsSUFBUyxFQUFFLElBQVk7SUFDN0MsSUFBSSxNQUEyQixDQUFDO0lBVWhDLE1BQU0sRUFBQyxVQUFVLEVBQUUsU0FBUyxFQUFDLEdBQUcsSUFBSSxDQUFDO0lBQ3JDLE1BQU0sTUFBTSxHQUFNLElBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzdDLE1BQU0sS0FBSyxHQUFPLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBUTVDLE1BQU0sYUFBYSxHQUFjLENBQUMsQ0FBQztJQUNuQyxNQUFNLFVBQVUsR0FBaUIsQ0FBQyxDQUFDO0lBQ25DLE1BQU0sZ0JBQWdCLEdBQVcsRUFBRSxDQUFDO0lBRXBDLFNBQVMsT0FBTyxDQUFJLEdBQVEsRUFBRSxNQUFjLElBQWMsT0FBTyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFFLEdBQUcsR0FBRyxNQUFNLENBQWEsQ0FBQyxDQUFDLENBQUM7SUFDbkksU0FBUyxRQUFRLENBQUcsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxJQUFJLENBQVEsQ0FBQyxDQUFDLENBQUM7SUFDcEksU0FBUyxRQUFRLENBQUcsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxJQUFJLENBQVEsQ0FBQyxDQUFDLENBQUM7SUFDcEksU0FBUyxVQUFVLENBQUMsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLFFBQVEsQ0FBRyxHQUFHLEVBQUUsTUFBTSxDQUFRLENBQUMsQ0FBQyxDQUFDO0lBQ2xHLFNBQVMsUUFBUSxDQUFHLEdBQVEsRUFBRSxNQUFjLElBQWMsT0FBTyxVQUFVLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBUSxDQUFDLENBQUMsQ0FBQztJQUVsRyxTQUFTLFFBQVEsQ0FBTyxHQUFRLEVBQUUsTUFBYyxFQUFFLEtBQVMsSUFBUyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFFLEdBQUcsR0FBRyxNQUFNLEVBQUUsS0FBSyxDQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3ZJLFNBQVMsU0FBUyxDQUFNLEdBQVEsRUFBRSxNQUFjLEVBQUUsS0FBVSxJQUFRLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZJLFNBQVMsU0FBUyxDQUFNLEdBQVEsRUFBRSxNQUFjLEVBQUUsS0FBVSxJQUFRLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxLQUFL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QUFDLEVBcEJTLFFBQVEsS0FBUixRQUFRLFFBb0JqQjtBQ3BCRCxJQUFVLFFBQVEsQ0EwQmpCO0FBMUJELFdBQVUsUUFBUTtJQXFCZCxTQUFnQixJQUFJLENBQUMsT0FBYTtRQUc3QixJQUFZLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFKZSxhQUFJLE9BSW5CLENBQUE7QUFDTCxDQUFDLEVBMUJTLFFBQVEsS0FBUixRQUFRLFFBMEJqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFUT01JQ19TVERJTl9GSUxMRUQgICA9IDA7XHJcbmNvbnN0IEFUT01JQ19TVERJTl9DT05TVU1FRCA9IDE7XHJcbmNvbnN0IEFUT01JQ19DT1VOVCA9IDI7XHJcblxyXG5jb25zdCBTVERJTl9CSVRTID0gMTA7XHJcbmNvbnN0IFNURElOX0NPVU5UID0gKDEgPDwgU1RESU5fQklUUyk7XHJcbmNvbnN0IFNURElOX01BU0sgPSBTVERJTl9DT1VOVC0xO1xyXG4iLCJmdW5jdGlvbiBleGVjX2Jhc2U2NF93YXNtKGRhdGE6IGFueSwgd2FzbTogc3RyaW5nKSB7XHJcbiAgICB2YXIgbWVtb3J5IDogV2ViQXNzZW1ibHkuTWVtb3J5O1xyXG5cclxuICAgIHR5cGUgRmQgICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwiZmRcIjsgfVxyXG4gICAgdHlwZSBFcnJubyAgPSBudW1iZXIgJiB7IF9ub3RfcmVhbDogXCJlcnJub1wiOyB9XHJcbiAgICB0eXBlIHB0ciAgICA9IG51bWJlciAmIHsgX25vdF9yZWFsOiBcInB0clwiOyB9XHJcbiAgICB0eXBlIHU4ICAgICA9IG51bWJlciAmIHsgX25vdF9yZWFsOiBcInU4XCI7IH1cclxuICAgIHR5cGUgdTE2ICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidTE2XCI7IH1cclxuICAgIHR5cGUgdTMyICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidTMyXCI7IH1cclxuICAgIHR5cGUgdXNpemUgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidXNpemVcIjsgfVxyXG5cclxuICAgIGNvbnN0IHthdG9taWNfc2FiLCBzdGRpbl9zYWJ9ID0gZGF0YTtcclxuICAgIGNvbnN0IGF0b21pYyAgICA9IG5ldyBJbnQzMkFycmF5KGF0b21pY19zYWIpO1xyXG4gICAgY29uc3Qgc3RkaW4gICAgID0gbmV3IFVpbnQ4QXJyYXkoc3RkaW5fc2FiKTtcclxuXHJcbiAgICAvLyBSZWZlcmVuY2VzOlxyXG4gICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2ktdHlwZXMvMC4xLjUvc3JjL3dhc2lfdHlwZXMvbGliLnJzLmh0bWxcclxuICAgIC8vIGh0dHBzOi8vZG9jcy5ycy93YXNpLzAuMTAuMit3YXNpLXNuYXBzaG90LXByZXZpZXcxL3NyYy93YXNpL2xpYl9nZW5lcmF0ZWQucnMuaHRtbFxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1dlYkFzc2VtYmx5L1dBU0kvYmxvYi9tYWluL3BoYXNlcy9zbmFwc2hvdC9kb2NzLm1kXHJcblxyXG4gICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzI3XHJcbiAgICBjb25zdCBFUlJOT19TVUNDRVNTICAgICA9IDxFcnJubz4wO1xyXG4gICAgY29uc3QgRVJSTk9fQkFERiAgICAgICAgPSA8RXJybm8+ODtcclxuICAgIGNvbnN0IEVSUk5PX05PVENBUEFCTEUgID0gPEVycm5vPjc2O1xyXG5cclxuICAgIGZ1bmN0aW9uIHJlYWRfdTgoICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogdTggICAgICAgeyByZXR1cm4gbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLmdldFVpbnQ4KCBwdHIgKyBvZmZzZXQgICAgICApIGFzIHU4OyB9XHJcbiAgICBmdW5jdGlvbiByZWFkX3UxNiggIHB0cjogcHRyLCBvZmZzZXQ6IG51bWJlcik6IHUxNiAgICAgIHsgcmV0dXJuIG5ldyBEYXRhVmlldyhtZW1vcnkuYnVmZmVyKS5nZXRVaW50MTYocHRyICsgb2Zmc2V0LCB0cnVlKSBhcyB1MTY7IH1cclxuICAgIGZ1bmN0aW9uIHJlYWRfdTMyKCAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogdTMyICAgICAgeyByZXR1cm4gbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLmdldFVpbnQzMihwdHIgKyBvZmZzZXQsIHRydWUpIGFzIHUzMjsgfVxyXG4gICAgZnVuY3Rpb24gcmVhZF91c2l6ZShwdHI6IHB0ciwgb2Zmc2V0OiBudW1iZXIpOiB1c2l6ZSAgICB7IHJldHVybiByZWFkX3UzMiggIHB0ciwgb2Zmc2V0KSBhcyBhbnk7IH1cclxuICAgIGZ1bmN0aW9uIHJlYWRfcHRyKCAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogcHRyICAgICAgeyByZXR1cm4gcmVhZF91c2l6ZShwdHIsIG9mZnNldCkgYXMgYW55OyB9XHJcblxyXG4gICAgZnVuY3Rpb24gd3JpdGVfdTgoICAgICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogdTggICAgICkgeyBuZXcgRGF0YVZpZXcobWVtb3J5LmJ1ZmZlcikuc2V0VWludDgoIHB0ciArIG9mZnNldCwgdmFsdWUgICAgICApOyB9XHJcbiAgICBmdW5jdGlvbiB3cml0ZV91MTYoICAgICBwdHI6IHB0ciwgb2Zmc2V0OiBudW1iZXIsIHZhbHVlOiB1MTYgICAgKSB7IG5ldyBEYXRhVmlldyhtZW1vcnkuYnVmZmVyKS5zZXRVaW50MTYocHRyICsgb2Zmc2V0LCB2YWx1ZSwgdHJ1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHdyaXRlX3UzMiggICAgIHB0cjogcHRyLCBvZmZzZXQ6IG51bWJlciwgdmFsdWU6IHUzMiAgICApIHsgbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLnNldFVpbnQzMihwdHIgKyBvZmZzZXQsIHZhbHVlLCB0cnVlKTsgfVxyXG4gICAgZnVuY3Rpb24gd3JpdGVfdXNpemUoICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogdXNpemUgICkgeyB3cml0ZV91MzIoICBwdHIsIG9mZnNldCwgdmFsdWUgYXMgYW55KTsgfVxyXG4gICAgZnVuY3Rpb24gd3JpdGVfcHRyKCAgICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogcHRyICAgICkgeyB3cml0ZV91c2l6ZShwdHIsIG9mZnNldCwgdmFsdWUgYXMgYW55KTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNsaWNlKHB0cjogcHRyLCBzdGFydDogdXNpemUsIGVuZDogdXNpemUpOiBEYXRhVmlldyB7IHJldHVybiBuZXcgRGF0YVZpZXcobWVtb3J5LmJ1ZmZlciwgcHRyK3N0YXJ0LCBlbmQtc3RhcnQpOyB9XHJcblxyXG4gICAgZnVuY3Rpb24gbnlpKCk6IEVycm5vIHtcclxuICAgICAgICAvL2RlYnVnZ2VyO1xyXG4gICAgICAgIHJldHVybiBFUlJOT19OT1RDQVBBQkxFO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFyZ3NfZ2V0ICAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gYXJnc19zaXplc19nZXQgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBlbnZpcm9uX2dldCAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGVudmlyb25fc2l6ZXNfZ2V0ICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gY2xvY2tfcmVzX2dldCAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBjbG9ja190aW1lX2dldCAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2FkdmlzZSAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfYWxsb2NhdGUgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9jbG9zZSAgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2RhdGFzeW5jICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfZmRzdGF0X2dldCAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9mZHN0YXRfc2V0X2ZsYWdzICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2Zkc3RhdF9zZXRfcmlnaHRzICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfZmlsZXN0YXRfZ2V0ICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9maWxlc3RhdF9zZXRfc2l6ZSAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2ZpbGVzdGF0X3NldF90aW1lcyAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfcHJlYWQgICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9wcmVzdGF0X2dldCAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3ByZXN0YXRfZGlyX25hbWUgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfcHdyaXRlICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmRfcmVhZChmZDogRmQsIGlvdmVjX2FycmF5X3B0cjogcHRyLCBpb3ZlY19hcnJheV9sZW46IHVzaXplLCBucmVhZF9wdHI6IHB0cik6IEVycm5vIHtcclxuICAgICAgICAvLyBodHRwczovL2RvY3MucnMvd2FzaS8wLjEwLjIrd2FzaS1zbmFwc2hvdC1wcmV2aWV3MS9zcmMvd2FzaS9saWJfZ2VuZXJhdGVkLnJzLmh0bWwjMTc1NFxyXG5cclxuICAgICAgICB2YXIgbnJlYWQgPSAwO1xyXG4gICAgICAgIHZhciBlcnJubyA9IEVSUk5PX1NVQ0NFU1M7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGlvdmVjX2lkeCA9IDA7IGlvdmVjX2lkeCA8IGlvdmVjX2FycmF5X2xlbjsgKytpb3ZlY19pZHgpIHtcclxuICAgICAgICAgICAgdmFyIGJ1Zl9wdHIgPSByZWFkX3B0cihpb3ZlY19hcnJheV9wdHIsIDggKiBpb3ZlY19pZHggKyAwKTtcclxuICAgICAgICAgICAgdmFyIGJ1Zl9sZW4gPSByZWFkX3VzaXplKGlvdmVjX2FycmF5X3B0ciwgOCAqIGlvdmVjX2lkeCArIDQpO1xyXG4gICAgICAgICAgICBpZiAoYnVmX2xlbiA8PSAwKSB7IGNvbnRpbnVlOyB9XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKGZkKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IC8vIHN0ZGluXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7Oykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uc3VtZWQgICAgPSBBdG9taWNzLmxvYWQoYXRvbWljLCBBVE9NSUNfU1RESU5fQ09OU1VNRUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoQXRvbWljcy53YWl0KGF0b21pYywgQVRPTUlDX1NURElOX0ZJTExFRCwgY29uc3VtZWQpICE9PSBcIm9rXCIpIHt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxsZWQgICAgICA9IEF0b21pY3MubG9hZChhdG9taWMsIEFUT01JQ19TVERJTl9GSUxMRUQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXZhaWxhYmxlICAgPSAoZmlsbGVkLWNvbnN1bWVkKXwwOyAvLyBhdmFpbGFibGUgKnRvIHJlYWQqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KGF2YWlsYWJsZSA+IDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IE1hdGgubWluKGF2YWlsYWJsZSwgYnVmX2xlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8bjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHN0ZGluWyhpK2NvbnN1bWVkKSZTVERJTl9NQVNLXSBhcyB1ODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmsyZG9tLnBvc3QoeyBraW5kOiBcImNvbnNvbGVcIiwgdGV4dDogbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKG5ldyBVaW50OEFycmF5KFtiXSkpIH0pOyAvLyBYWFg6IGxvY2FsIGVjaG9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlX3U4KGJ1Zl9wdHIsIGksIGIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEF0b21pY3Muc3RvcmUoYXRvbWljLCBBVE9NSUNfU1RESU5fQ09OU1VNRUQsIChjb25zdW1lZCtuKXwwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5yZWFkICs9IG47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgZXJybm8gPSBFUlJOT19CQURGO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3cml0ZV91c2l6ZShucmVhZF9wdHIsIDAsIG5yZWFkIGFzIHVzaXplKTtcclxuICAgICAgICByZXR1cm4gZXJybm87XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmRfcmVhZGRpciAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9yZW51bWJlciAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3NlZWsgICAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfc3luYyAgICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF90ZWxsICAgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuXHJcbiAgICBmdW5jdGlvbiBmZF93cml0ZShmZDogRmQsIGNpb3ZlY19hcnJheV9wdHI6IHB0ciwgY2lvdmVjX2FycmF5X2xlbjogdXNpemUsIG53cml0dGVuX3B0cjogcHRyKTogRXJybm8ge1xyXG4gICAgICAgIC8vIGh0dHBzOi8vZG9jcy5ycy93YXNpLzAuMTAuMit3YXNpLXNuYXBzaG90LXByZXZpZXcxL3NyYy93YXNpL2xpYl9nZW5lcmF0ZWQucnMuaHRtbCMxNzk2XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9ub2RlanMub3JnL2FwaS93YXNpLmh0bWxcclxuXHJcbiAgICAgICAgdmFyIG53cml0dGVuID0gMDtcclxuICAgICAgICB2YXIgZXJybm8gPSBFUlJOT19TVUNDRVNTO1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IFwiXCI7XHJcbiAgICAgICAgZm9yICh2YXIgY2lvdmVjX2lkeCA9IDA7IGNpb3ZlY19pZHggPCBjaW92ZWNfYXJyYXlfbGVuOyArK2Npb3ZlY19pZHgpIHtcclxuICAgICAgICAgICAgdmFyIGJ1Zl9wdHIgPSByZWFkX3B0cihjaW92ZWNfYXJyYXlfcHRyLCA4ICogY2lvdmVjX2lkeCArIDApO1xyXG4gICAgICAgICAgICB2YXIgYnVmX2xlbiA9IHJlYWRfdXNpemUoY2lvdmVjX2FycmF5X3B0ciwgOCAqIGNpb3ZlY19pZHggKyA0KTtcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCAoZmQpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTogLy8gc3Rkb3V0XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IC8vIHN0ZGVyclxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgKz0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHNsaWNlKGJ1Zl9wdHIsIDAgYXMgdXNpemUsIGJ1Zl9sZW4pKTtcclxuICAgICAgICAgICAgICAgICAgICBud3JpdHRlbiArPSBidWZfbGVuO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBlcnJubyA9IEVSUk5PX0JBREY7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0ZXh0ICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHdvcmsyZG9tLnBvc3QoeyBraW5kOiBcImNvbnNvbGVcIiwgdGV4dCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdyaXRlX3VzaXplKG53cml0dGVuX3B0ciwgMCwgbndyaXR0ZW4gYXMgdXNpemUpO1xyXG4gICAgICAgIHJldHVybiBlcnJubztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYXRoX2NyZWF0ZV9kaXJlY3RvcnkgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfZmlsZXN0YXRzX2dldCAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9maWxlc3RhdF9zZXRfdGltZXMgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX2xpbmsgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfb3BlbiAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9yZWFkbGluayAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX3JlbW92ZV9kaXJlY3RvcnkgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfcmVuYW1lICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9zeW1saW5rICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX3VubGlua19maWxlICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBvbGxfb25lb2ZmICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHByb2NfZXhpdChjb2RlOiBudW1iZXIpOiBuZXZlciB7XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzE5MDFcclxuICAgICAgICB3b3JrMmRvbS5wb3N0KHsga2luZDogXCJwcm9jX2V4aXRcIiwgY29kZSB9KTtcclxuICAgICAgICB0aHJvdyBcImV4aXRcIjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwcm9jX3JhaXNlICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHNjaGVkX3lpZWxkICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcmFuZG9tX2dldCAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBzb2NrX3JlY3YgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHNvY2tfc2VuZCAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gc29ja19zaHV0ZG93biAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcblxyXG4gICAgY29uc3QgaW1wb3J0cyA9IHtcclxuICAgICAgICB3YXNpX3NuYXBzaG90X3ByZXZpZXcxOiB7XHJcbiAgICAgICAgICAgIGFyZ3NfZ2V0LFxyXG4gICAgICAgICAgICBhcmdzX3NpemVzX2dldCxcclxuICAgICAgICAgICAgZW52aXJvbl9nZXQsXHJcbiAgICAgICAgICAgIGVudmlyb25fc2l6ZXNfZ2V0LFxyXG4gICAgICAgICAgICBjbG9ja19yZXNfZ2V0LFxyXG4gICAgICAgICAgICBjbG9ja190aW1lX2dldCxcclxuICAgICAgICAgICAgZmRfYWR2aXNlLFxyXG4gICAgICAgICAgICBmZF9hbGxvY2F0ZSxcclxuICAgICAgICAgICAgZmRfY2xvc2UsXHJcbiAgICAgICAgICAgIGZkX2RhdGFzeW5jLFxyXG4gICAgICAgICAgICBmZF9mZHN0YXRfZ2V0LFxyXG4gICAgICAgICAgICBmZF9mZHN0YXRfc2V0X2ZsYWdzLFxyXG4gICAgICAgICAgICBmZF9mZHN0YXRfc2V0X3JpZ2h0cyxcclxuICAgICAgICAgICAgZmRfZmlsZXN0YXRfZ2V0LFxyXG4gICAgICAgICAgICBmZF9maWxlc3RhdF9zZXRfc2l6ZSxcclxuICAgICAgICAgICAgZmRfZmlsZXN0YXRfc2V0X3RpbWVzLFxyXG4gICAgICAgICAgICBmZF9wcmVhZCxcclxuICAgICAgICAgICAgZmRfcHJlc3RhdF9nZXQsXHJcbiAgICAgICAgICAgIGZkX3ByZXN0YXRfZGlyX25hbWUsXHJcbiAgICAgICAgICAgIGZkX3B3cml0ZSxcclxuICAgICAgICAgICAgZmRfcmVhZCxcclxuICAgICAgICAgICAgZmRfcmVhZGRpcixcclxuICAgICAgICAgICAgZmRfcmVudW1iZXIsXHJcbiAgICAgICAgICAgIGZkX3NlZWssXHJcbiAgICAgICAgICAgIGZkX3N5bmMsXHJcbiAgICAgICAgICAgIGZkX3RlbGwsXHJcbiAgICAgICAgICAgIGZkX3dyaXRlLFxyXG4gICAgICAgICAgICBwYXRoX2NyZWF0ZV9kaXJlY3RvcnksXHJcbiAgICAgICAgICAgIHBhdGhfZmlsZXN0YXRzX2dldCxcclxuICAgICAgICAgICAgcGF0aF9maWxlc3RhdF9zZXRfdGltZXMsXHJcbiAgICAgICAgICAgIHBhdGhfbGluayxcclxuICAgICAgICAgICAgcGF0aF9vcGVuLFxyXG4gICAgICAgICAgICBwYXRoX3JlYWRsaW5rLFxyXG4gICAgICAgICAgICBwYXRoX3JlbW92ZV9kaXJlY3RvcnksXHJcbiAgICAgICAgICAgIHBhdGhfcmVuYW1lLFxyXG4gICAgICAgICAgICBwYXRoX3N5bWxpbmssXHJcbiAgICAgICAgICAgIHBhdGhfdW5saW5rX2ZpbGUsXHJcbiAgICAgICAgICAgIHBvbGxfb25lb2ZmLFxyXG4gICAgICAgICAgICBwcm9jX2V4aXQsXHJcbiAgICAgICAgICAgIHByb2NfcmFpc2UsXHJcbiAgICAgICAgICAgIHNjaGVkX3lpZWxkLFxyXG4gICAgICAgICAgICByYW5kb21fZ2V0LFxyXG4gICAgICAgICAgICBzb2NrX3JlY3YsXHJcbiAgICAgICAgICAgIHNvY2tfc2VuZCxcclxuICAgICAgICAgICAgc29ja19zaHV0ZG93bixcclxuICAgICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBiaW5hcnkgPSBhdG9iKHdhc20pO1xyXG4gICAgY29uc3QgdHlwZWRhcnJheSA9IG5ldyBVaW50OEFycmF5KGJpbmFyeS5sZW5ndGgpO1xyXG4gICAgZm9yICh2YXIgaT0wOyBpPGJpbmFyeS5sZW5ndGg7ICsraSkgeyB0eXBlZGFycmF5W2ldID0gYmluYXJ5LmNoYXJDb2RlQXQoaSk7IH1cclxuXHJcbiAgICBXZWJBc3NlbWJseS5jb21waWxlKHR5cGVkYXJyYXkpLnRoZW4oZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICBpZiAoZmFsc2UpIHtcclxuICAgICAgICAgICAgV2ViQXNzZW1ibHkuTW9kdWxlLmltcG9ydHMobSkuZm9yRWFjaChmdW5jdGlvbiAoaW1wKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImltcG9ydFwiLCBpbXApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgV2ViQXNzZW1ibHkuTW9kdWxlLmV4cG9ydHMobSkuZm9yRWFjaChmdW5jdGlvbiAoZXhwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImV4cG9ydFwiLCBleHApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKG0sIGltcG9ydHMpO1xyXG4gICAgfSkudGhlbihmdW5jdGlvbiAobSkge1xyXG4gICAgICAgIG1lbW9yeSA9IDxhbnk+bS5leHBvcnRzLm1lbW9yeTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAobS5leHBvcnRzLm1haW4gYXMgYW55KSgpO1xyXG4gICAgICAgICAgICBwcm9jX2V4aXQoMCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZiAoZSAhPT0gXCJleGl0XCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICBkZWJ1Z2dlcjtcclxuICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICBzZWxmLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuIiwidmFyIG1haW5fZG9tX3dvcmtlciA6IFdvcmtlcjtcclxuZnVuY3Rpb24gbWFpbl9kb20oKSB7XHJcbiAgICBjb25zdCBjb24gICAgICAgPSByZXF1aXJlRWxlbWVudEJ5SWQoXCJjb25zb2xlXCIpO1xyXG4gICAgY29uc3QgY3Vyc29yICAgID0gcmVxdWlyZUVsZW1lbnRCeUlkKFwiY3Vyc29yXCIpO1xyXG5cclxuICAgIGNvbnN0IGF0b21pY19zYWIgICAgPSBuZXcgU2hhcmVkQXJyYXlCdWZmZXIoNCAqIEFUT01JQ19DT1VOVCk7XHJcbiAgICBjb25zdCBhdG9taWMgICAgICAgID0gbmV3IEludDMyQXJyYXkoYXRvbWljX3NhYik7XHJcbiAgICBjb25zdCBzdGRpbl9zYWIgICAgID0gbmV3IFNoYXJlZEFycmF5QnVmZmVyKFNURElOX0NPVU5UKTtcclxuICAgIGNvbnN0IHN0ZGluICAgICAgICAgPSBuZXcgVWludDhBcnJheShzdGRpbl9zYWIpO1xyXG5cclxuICAgIC8vIHNwYXduIHdlYiB3b3JrZXJcclxuICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYig8QmxvYlBhcnRbXT5BcnJheS5wcm90b3R5cGUubWFwLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0Om5vdChbZGF0YS1qcy13b3JrZXI9XFwnZmFsc2VcXCddKScpLCBmdW5jdGlvbiAob1NjcmlwdCkgeyByZXR1cm4gb1NjcmlwdC50ZXh0Q29udGVudDsgfSkse3R5cGU6ICd0ZXh0L2phdmFzY3JpcHQnfSk7XHJcbiAgICBtYWluX2RvbV93b3JrZXIgPSBuZXcgV29ya2VyKHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpKTtcclxuICAgIG1haW5fZG9tX3dvcmtlci5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlOiB3b3JrMmRvbS5FdmVudCkge1xyXG4gICAgICAgIHN3aXRjaCAoZS5kYXRhLmtpbmQpIHtcclxuICAgICAgICAgICAgY2FzZSBcImNvbnNvbGVcIjpcclxuICAgICAgICAgICAgICAgIGNvbi5pbnNlcnRCZWZvcmUoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZS5kYXRhLnRleHQpLCBjdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwcm9jX2V4aXRcIjpcclxuICAgICAgICAgICAgICAgIHZhciBleGl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcbiAgICAgICAgICAgICAgICBleGl0LnRleHRDb250ZW50ID0gYFxcbnByb2Nlc3MgZXhpdGVkIHdpdGggY29kZSAke2UuZGF0YS5jb2RlfWA7XHJcbiAgICAgICAgICAgICAgICBleGl0LnN0eWxlLmNvbG9yID0gXCIjODg4XCI7XHJcbiAgICAgICAgICAgICAgICBjb24uaW5zZXJ0QmVmb3JlKGV4aXQsIGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBjb24ucmVtb3ZlQ2hpbGQoY3Vyc29yKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcInVuZXhwZWN0ZWQgZXZlbnQga2luZFwiLCBlLmRhdGEua2luZCk7XHJcbiAgICAgICAgICAgICAgICBkZWJ1Z2dlcjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBkb20yd29yay5wb3N0KHtcclxuICAgICAgICBraW5kOiBcImluaXRcIixcclxuICAgICAgICBhdG9taWNfc2FiLFxyXG4gICAgICAgIHN0ZGluX3NhYixcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBzdGRpbl9idWZmZXIgOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICB2YXIgdGV4dCA9IGUuY2hhciB8fCBTdHJpbmcuZnJvbUNoYXJDb2RlKGUuY2hhckNvZGUpO1xyXG4gICAgICAgIGlmICh0ZXh0ID09PSBcIlxcclwiKSB7IHRleHQgPSBcIlxcblwiOyB9XHJcbiAgICAgICAgdmFyIGNoYXJzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHRleHQpO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxjaGFycy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBzdGRpbl9idWZmZXIucHVzaChjaGFyc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcclxuICAgICAgICBpZiAoc3RkaW5fYnVmZmVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgZmlsbGVkICAgICAgPSBBdG9taWNzLmxvYWQoYXRvbWljLCBBVE9NSUNfU1RESU5fRklMTEVEKTtcclxuICAgICAgICB2YXIgY29uc3VtZWQgICAgPSBBdG9taWNzLmxvYWQoYXRvbWljLCBBVE9NSUNfU1RESU5fQ09OU1VNRUQpO1xyXG4gICAgICAgIHZhciBhdmFpbGFibGUgICA9IFNURElOX0NPVU5UIC0gKChmaWxsZWQtY29uc3VtZWQpfDApOyAvLyBhdmFpbGFibGUgKnRvIHdyaXRlKlxyXG5cclxuICAgICAgICB2YXIgbiA9IE1hdGgubWluKGF2YWlsYWJsZSwgc3RkaW5fYnVmZmVyLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpPG47ICsraSkge1xyXG4gICAgICAgICAgICBzdGRpblsoaStmaWxsZWQpJlNURElOX01BU0tdID0gc3RkaW5fYnVmZmVyW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGRpbl9idWZmZXIuc3BsaWNlKDAsIG4pO1xyXG4gICAgICAgIGZpbGxlZCA9IChmaWxsZWQrbil8MDtcclxuICAgICAgICBBdG9taWNzLnN0b3JlKGF0b21pYywgQVRPTUlDX1NURElOX0ZJTExFRCwgZmlsbGVkKTtcclxuICAgICAgICBBdG9taWNzLm5vdGlmeShhdG9taWMsIEFUT01JQ19TVERJTl9GSUxMRUQsICtJbmZpbml0eSk7XHJcbiAgICB9LCAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVxdWlyZUVsZW1lbnRCeUlkKGlkOiBzdHJpbmcpOiBIVE1MRWxlbWVudCB7XHJcbiAgICBsZXQgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICBpZiAoIWVsKSB7IHRocm93IGBubyBzdWNoIGVsZW1lbnQgaW4gZG9jdW1lbnQ6ICMke2lkfWA7IH1cclxuICAgIHJldHVybiBlbDtcclxufVxyXG4iLCJmdW5jdGlvbiBtYWluX3dvcmtlcigpIHtcclxuICAgIHNlbGYub25tZXNzYWdlID0gZnVuY3Rpb24oZTogZG9tMndvcmsuRXZlbnQpIHtcclxuICAgICAgICBzd2l0Y2ggKGUuZGF0YS5raW5kKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJpbml0XCI6XHJcbiAgICAgICAgICAgICAgICBleGVjX2Jhc2U2NF93YXNtKGUuZGF0YSwgXCJ7QkFTRTY0X1dBU00zMn1cIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJ1bmV4cGVjdGVkIGV2ZW50IGtpbmRcIiwgZS5kYXRhLmtpbmQpO1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbiIsIm5hbWVzcGFjZSBkb20yd29yayB7XHJcbiAgICBpbnRlcmZhY2UgSW5pdCB7XHJcbiAgICAgICAga2luZDogXCJpbml0XCI7XHJcbiAgICAgICAgYXRvbWljX3NhYjogU2hhcmVkQXJyYXlCdWZmZXIsXHJcbiAgICAgICAgc3RkaW5fc2FiOiAgU2hhcmVkQXJyYXlCdWZmZXIsXHJcbiAgICB9XHJcblxyXG4gICAgaW50ZXJmYWNlIE90aGVyIHtcclxuICAgICAgICBraW5kOiBcIl9vdGhlclwiO1xyXG4gICAgfVxyXG5cclxuICAgIHR5cGUgRGF0YSA9IEluaXQgfCBPdGhlcjtcclxuXHJcbiAgICBleHBvcnQgaW50ZXJmYWNlIEV2ZW50IGV4dGVuZHMgTWVzc2FnZUV2ZW50IHtcclxuICAgICAgICByZWFkb25seSBkYXRhOiBEYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBwb3N0KGRhdGE6IERhdGEpIHtcclxuICAgICAgICBtYWluX2RvbV93b3JrZXIucG9zdE1lc3NhZ2UoZGF0YSk7XHJcbiAgICB9XHJcbn1cclxuIiwibmFtZXNwYWNlIHdvcmsyZG9tIHtcclxuICAgIGludGVyZmFjZSBDb25zb2xlIHtcclxuICAgICAgICBraW5kOiAgIFwiY29uc29sZVwiO1xyXG4gICAgICAgIHRleHQ6ICAgc3RyaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIGludGVyZmFjZSBQcm9jRXhpdCB7XHJcbiAgICAgICAga2luZDogICBcInByb2NfZXhpdFwiO1xyXG4gICAgICAgIGNvZGU6ICAgbnVtYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGludGVyZmFjZSBPdGhlciB7XHJcbiAgICAgICAga2luZDogICBcIl9vdGhlclwiO1xyXG4gICAgfVxyXG5cclxuICAgIHR5cGUgRGF0YSA9IENvbnNvbGUgfCBQcm9jRXhpdCB8IE90aGVyO1xyXG5cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgRXZlbnQgZXh0ZW5kcyBNZXNzYWdlRXZlbnQge1xyXG4gICAgICAgIHJlYWRvbmx5IGRhdGE6IERhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIHBvc3QobWVzc2FnZTogRGF0YSkge1xyXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9EZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZS9wb3N0TWVzc2FnZSBub3RcclxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2luZG93L3Bvc3RNZXNzYWdlXHJcbiAgICAgICAgKHNlbGYgYXMgYW55KS5wb3N0TWVzc2FnZShtZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG4iXX0=