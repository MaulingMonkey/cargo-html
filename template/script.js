const ATOMIC_STDIN_FILLED = 0;
const ATOMIC_STDIN_CONSUMED = 1;
const ATOMIC_COUNT = 2;
const STDIN_BITS = 10;
const STDIN_COUNT = (1 << STDIN_BITS);
const STDIN_MASK = STDIN_COUNT - 1;
function exec_base64_wasm(data, wasm) {
    var memory;
    const { atomic_sab, stdin_sab } = data;
    const atomic = new Int32Array(atomic_sab);
    const stdin = new Uint8Array(stdin_sab);
    const ERRNO_SUCCESS = 0;
    const ERRNO_BADF = 8;
    const ERRNO_NOTCAPABLE = 76;
    function read_u8(ptr, offset) { return new DataView(memory.buffer).getUint8(ptr + offset); }
    function read_u16(ptr, offset) { return new DataView(memory.buffer).getUint16(ptr + offset, true); }
    function read_u32(ptr, offset) { return new DataView(memory.buffer).getUint32(ptr + offset, true); }
    function read_usize(ptr, offset) { return read_u32(ptr, offset); }
    function read_ptr(ptr, offset) { return read_usize(ptr, offset); }
    function write_u8(ptr, offset, value) { new DataView(memory.buffer).setUint8(ptr + offset, value); }
    function write_u16(ptr, offset, value) { new DataView(memory.buffer).setUint16(ptr + offset, value, true); }
    function write_u32(ptr, offset, value) { new DataView(memory.buffer).setUint32(ptr + offset, value, true); }
    function write_usize(ptr, offset, value) { write_u32(ptr, offset, value); }
    function write_ptr(ptr, offset, value) { write_usize(ptr, offset, value); }
    function slice(ptr, start, end) { return new DataView(memory.buffer, ptr + start, end - start); }
    function nyi() {
        return ERRNO_NOTCAPABLE;
    }
    function work2dom(message) {
        self.postMessage(message);
    }
    function args_get() { return nyi(); }
    function args_sizes_get() { return nyi(); }
    function environ_get() { return nyi(); }
    function environ_sizes_get() { return nyi(); }
    function clock_res_get() { return nyi(); }
    function clock_time_get() { return nyi(); }
    function fd_advise() { return nyi(); }
    function fd_allocate() { return nyi(); }
    function fd_close() { return nyi(); }
    function fd_datasync() { return nyi(); }
    function fd_fdstat_get() { return nyi(); }
    function fd_fdstat_set_flags() { return nyi(); }
    function fd_fdstat_set_rights() { return nyi(); }
    function fd_filestat_get() { return nyi(); }
    function fd_filestat_set_size() { return nyi(); }
    function fd_filestat_set_times() { return nyi(); }
    function fd_pread() { return nyi(); }
    function fd_prestat_get() { return nyi(); }
    function fd_prestat_dir_name() { return nyi(); }
    function fd_pwrite() { return nyi(); }
    function fd_read(fd, iovec_array_ptr, iovec_array_len, nread_ptr) {
        var nread = 0;
        var errno = ERRNO_SUCCESS;
        for (var iovec_idx = 0; iovec_idx < iovec_array_len; ++iovec_idx) {
            var buf_ptr = read_ptr(iovec_array_ptr, 8 * iovec_idx + 0);
            var buf_len = read_usize(iovec_array_ptr, 8 * iovec_idx + 4);
            if (buf_len <= 0) {
                continue;
            }
            switch (fd) {
                case 0:
                    for (;;) {
                        var consumed = Atomics.load(atomic, ATOMIC_STDIN_CONSUMED);
                        while (Atomics.wait(atomic, ATOMIC_STDIN_FILLED, consumed) !== "ok") { }
                        var filled = Atomics.load(atomic, ATOMIC_STDIN_FILLED);
                        var available = (filled - consumed) | 0;
                        console.assert(available > 0);
                        var n = Math.min(available, buf_len);
                        for (var i = 0; i < n; ++i) {
                            var b = stdin[(i + consumed) & STDIN_MASK];
                            work2dom({ kind: "console", text: new TextDecoder().decode(new Uint8Array([b])) });
                            write_u8(buf_ptr, i, b);
                        }
                        Atomics.store(atomic, ATOMIC_STDIN_CONSUMED, (consumed + n) | 0);
                        nread += n;
                        break;
                    }
                    break;
                default:
                    errno = ERRNO_BADF;
                    break;
            }
        }
        write_usize(nread_ptr, 0, nread);
        return errno;
    }
    function fd_readdir() { return nyi(); }
    function fd_renumber() { return nyi(); }
    function fd_seek() { return nyi(); }
    function fd_sync() { return nyi(); }
    function fd_tell() { return nyi(); }
    function fd_write(fd, ciovec_array_ptr, ciovec_array_len, nwritten_ptr) {
        var nwritten = 0;
        var errno = ERRNO_SUCCESS;
        var text = "";
        for (var ciovec_idx = 0; ciovec_idx < ciovec_array_len; ++ciovec_idx) {
            var buf_ptr = read_ptr(ciovec_array_ptr, 8 * ciovec_idx + 0);
            var buf_len = read_usize(ciovec_array_ptr, 8 * ciovec_idx + 4);
            switch (fd) {
                case 1:
                case 2:
                    text += new TextDecoder().decode(slice(buf_ptr, 0, buf_len));
                    nwritten += buf_len;
                    break;
                default:
                    errno = ERRNO_BADF;
                    break;
            }
        }
        if (text !== "") {
            work2dom({ kind: "console", text });
        }
        write_usize(nwritten_ptr, 0, nwritten);
        return errno;
    }
    function path_create_directory() { return nyi(); }
    function path_filestats_get() { return nyi(); }
    function path_filestat_set_times() { return nyi(); }
    function path_link() { return nyi(); }
    function path_open() { return nyi(); }
    function path_readlink() { return nyi(); }
    function path_remove_directory() { return nyi(); }
    function path_rename() { return nyi(); }
    function path_symlink() { return nyi(); }
    function path_unlink_file() { return nyi(); }
    function poll_oneoff() { return nyi(); }
    function proc_exit(code) {
        work2dom({ kind: "proc_exit", code });
        throw "exit";
    }
    function proc_raise() { return nyi(); }
    function sched_yield() { return nyi(); }
    function random_get() { return nyi(); }
    function sock_recv() { return nyi(); }
    function sock_send() { return nyi(); }
    function sock_shutdown() { return nyi(); }
    const imports = {
        wasi_snapshot_preview1: {
            args_get,
            args_sizes_get,
            environ_get,
            environ_sizes_get,
            clock_res_get,
            clock_time_get,
            fd_advise,
            fd_allocate,
            fd_close,
            fd_datasync,
            fd_fdstat_get,
            fd_fdstat_set_flags,
            fd_fdstat_set_rights,
            fd_filestat_get,
            fd_filestat_set_size,
            fd_filestat_set_times,
            fd_pread,
            fd_prestat_get,
            fd_prestat_dir_name,
            fd_pwrite,
            fd_read,
            fd_readdir,
            fd_renumber,
            fd_seek,
            fd_sync,
            fd_tell,
            fd_write,
            path_create_directory,
            path_filestats_get,
            path_filestat_set_times,
            path_link,
            path_open,
            path_readlink,
            path_remove_directory,
            path_rename,
            path_symlink,
            path_unlink_file,
            poll_oneoff,
            proc_exit,
            proc_raise,
            sched_yield,
            random_get,
            sock_recv,
            sock_send,
            sock_shutdown,
        },
    };
    const binary = atob(wasm);
    const typedarray = new Uint8Array(binary.length);
    for (var i = 0; i < binary.length; ++i) {
        typedarray[i] = binary.charCodeAt(i);
    }
    WebAssembly.compile(typedarray).then(function (m) {
        if (false) {
            WebAssembly.Module.imports(m).forEach(function (imp) {
                console.log("import", imp);
            });
            WebAssembly.Module.exports(m).forEach(function (exp) {
                console.log("export", exp);
            });
        }
        return WebAssembly.instantiate(m, imports);
    }).then(function (m) {
        memory = m.exports.memory;
        try {
            m.exports.main();
            proc_exit(0);
        }
        catch (e) {
            if (e !== "exit") {
                console.error(e);
                debugger;
                throw e;
            }
        }
        finally {
            self.close();
        }
    });
}
function dom2work(data) {
    main_dom_worker.postMessage(data);
}
var main_dom_worker;
function main_dom() {
    const con = requireElementById("console");
    const cursor = requireElementById("cursor");
    const atomic_sab = new SharedArrayBuffer(4 * ATOMIC_COUNT);
    const atomic = new Int32Array(atomic_sab);
    const stdin_sab = new SharedArrayBuffer(STDIN_COUNT);
    const stdin = new Uint8Array(stdin_sab);
    const blob = new Blob(Array.prototype.map.call(document.querySelectorAll('script:not([data-js-worker=\'false\'])'), function (oScript) { return oScript.textContent; }), { type: 'text/javascript' });
    main_dom_worker = new Worker(window.URL.createObjectURL(blob));
    main_dom_worker.onmessage = function (e) {
        switch (e.data.kind) {
            case "console":
                con.insertBefore(document.createTextNode(e.data.text), cursor);
                break;
            case "proc_exit":
                var exit = document.createElement("span");
                exit.textContent = `\nprocess exited with code ${e.data.code}`;
                exit.style.color = "#888";
                con.insertBefore(exit, cursor);
                con.removeChild(cursor);
                break;
            default:
                console.error("unexpected event kind", e.data.kind);
                debugger;
                break;
        }
    };
    dom2work({
        kind: "init",
        atomic_sab,
        stdin_sab,
    });
    var stdin_buffer = [];
    document.addEventListener("keypress", function (e) {
        var text = e.char || String.fromCharCode(e.charCode);
        if (text === "\r") {
            text = "\n";
        }
        var chars = new TextEncoder().encode(text);
        for (var i = 0; i < chars.length; ++i) {
            stdin_buffer.push(chars[i]);
        }
    });
    setInterval(function () {
        if (stdin_buffer.length === 0)
            return;
        var filled = Atomics.load(atomic, ATOMIC_STDIN_FILLED);
        var consumed = Atomics.load(atomic, ATOMIC_STDIN_CONSUMED);
        var available = STDIN_COUNT - ((filled - consumed) | 0);
        var n = Math.min(available, stdin_buffer.length);
        for (var i = 0; i < n; ++i) {
            stdin[(i + filled) & STDIN_MASK] = stdin_buffer[i];
        }
        stdin_buffer.splice(0, n);
        filled = (filled + n) | 0;
        Atomics.store(atomic, ATOMIC_STDIN_FILLED, filled);
        Atomics.notify(atomic, ATOMIC_STDIN_FILLED, +Infinity);
    }, 0);
}
function requireElementById(id) {
    let el = document.getElementById(id);
    if (!el) {
        throw `no such element in document: #${id}`;
    }
    return el;
}
function main_worker() {
    self.onmessage = function (e) {
        switch (e.data.kind) {
            case "init":
                exec_base64_wasm(e.data, "{BASE64_WASM32}");
                break;
            default:
                console.error("unexpected event kind", e.data.kind);
                debugger;
                break;
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc2NyaXB0L2NvbnN0YW50cy50cyIsIi4uL3NjcmlwdC9leGVjLXdhc20udHMiLCIuLi9zY3JpcHQvbWFpbi1kb20udHMiLCIuLi9zY3JpcHQvbWFpbi13b3JrZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxtQkFBbUIsR0FBSyxDQUFDLENBQUM7QUFDaEMsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLENBQUM7QUFDaEMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxDQUFDO0FBRXZCLE1BQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztBQUN0QixNQUFNLFdBQVcsR0FBRyxDQUFDLENBQUMsSUFBSSxVQUFVLENBQUMsQ0FBQztBQUN0QyxNQUFNLFVBQVUsR0FBRyxXQUFXLEdBQUMsQ0FBQyxDQUFDO0FDTmpDLFNBQVMsZ0JBQWdCLENBQUMsSUFBUyxFQUFFLElBQVk7SUFDN0MsSUFBSSxNQUEyQixDQUFDO0lBVWhDLE1BQU0sRUFBQyxVQUFVLEVBQUUsU0FBUyxFQUFDLEdBQUcsSUFBSSxDQUFDO0lBQ3JDLE1BQU0sTUFBTSxHQUFNLElBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzdDLE1BQU0sS0FBSyxHQUFPLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBUTVDLE1BQU0sYUFBYSxHQUFjLENBQUMsQ0FBQztJQUNuQyxNQUFNLFVBQVUsR0FBaUIsQ0FBQyxDQUFDO0lBQ25DLE1BQU0sZ0JBQWdCLEdBQVcsRUFBRSxDQUFDO0lBRXBDLFNBQVMsT0FBTyxDQUFJLEdBQVEsRUFBRSxNQUFjLElBQWMsT0FBTyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFFLEdBQUcsR0FBRyxNQUFNLENBQWEsQ0FBQyxDQUFDLENBQUM7SUFDbkksU0FBUyxRQUFRLENBQUcsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxJQUFJLENBQVEsQ0FBQyxDQUFDLENBQUM7SUFDcEksU0FBUyxRQUFRLENBQUcsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxJQUFJLENBQVEsQ0FBQyxDQUFDLENBQUM7SUFDcEksU0FBUyxVQUFVLENBQUMsR0FBUSxFQUFFLE1BQWMsSUFBYyxPQUFPLFFBQVEsQ0FBRyxHQUFHLEVBQUUsTUFBTSxDQUFRLENBQUMsQ0FBQyxDQUFDO0lBQ2xHLFNBQVMsUUFBUSxDQUFHLEdBQVEsRUFBRSxNQUFjLElBQWMsT0FBTyxVQUFVLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBUSxDQUFDLENBQUMsQ0FBQztJQUVsRyxTQUFTLFFBQVEsQ0FBTyxHQUFRLEVBQUUsTUFBYyxFQUFFLEtBQVMsSUFBUyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFFLEdBQUcsR0FBRyxNQUFNLEVBQUUsS0FBSyxDQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3ZJLFNBQVMsU0FBUyxDQUFNLEdBQVEsRUFBRSxNQUFjLEVBQUUsS0FBVSxJQUFRLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZJLFNBQVMsU0FBUyxDQUFNLEdBQVEsRUFBRSxNQUFjLEVBQUUsS0FBVSxJQUFRLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZJLFNBQVMsV0FBVyxDQUFJLEdBQVEsRUFBRSxNQUFj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QyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNsRDtRQUNELFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzFCLE1BQU0sR0FBRyxDQUFDLE1BQU0sR0FBQyxDQUFDLENBQUMsR0FBQyxDQUFDLENBQUM7UUFDdEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDbkQsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMzRCxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDVixDQUFDO0FBRUQsU0FBUyxrQkFBa0IsQ0FBQyxFQUFVO0lBQ2xDLElBQUksRUFBRSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDckMsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUFFLE1BQU0saUNBQWlDLEVBQUUsRUFBRSxDQUFDO0tBQUU7SUFDekQsT0FBTyxFQUFFLENBQUM7QUFDZCxDQUFDO0FDL0VELFNBQVMsV0FBVztJQUNoQixJQUFJLENBQUMsU0FBUyxHQUFHLFVBQVMsQ0FBcUI7UUFDM0MsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNqQixLQUFLLE1BQU07Z0JBQ1AsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dCQUM1QyxNQUFNO1lBQ1Y7Z0JBQ0ksT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNwRCxRQUFRLENBQUM7Z0JBQ1QsTUFBTTtTQUNiO0lBQ0wsQ0FBQyxDQUFDO0FBQ04sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFUT01JQ19TVERJTl9GSUxMRUQgICA9IDA7XHJcbmNvbnN0IEFUT01JQ19TVERJTl9DT05TVU1FRCA9IDE7XHJcbmNvbnN0IEFUT01JQ19DT1VOVCA9IDI7XHJcblxyXG5jb25zdCBTVERJTl9CSVRTID0gMTA7XHJcbmNvbnN0IFNURElOX0NPVU5UID0gKDEgPDwgU1RESU5fQklUUyk7XHJcbmNvbnN0IFNURElOX01BU0sgPSBTVERJTl9DT1VOVC0xO1xyXG4iLCJmdW5jdGlvbiBleGVjX2Jhc2U2NF93YXNtKGRhdGE6IGFueSwgd2FzbTogc3RyaW5nKSB7XHJcbiAgICB2YXIgbWVtb3J5IDogV2ViQXNzZW1ibHkuTWVtb3J5O1xyXG5cclxuICAgIHR5cGUgRmQgICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwiZmRcIjsgfVxyXG4gICAgdHlwZSBFcnJubyAgPSBudW1iZXIgJiB7IF9ub3RfcmVhbDogXCJlcnJub1wiOyB9XHJcbiAgICB0eXBlIHB0ciAgICA9IG51bWJlciAmIHsgX25vdF9yZWFsOiBcInB0clwiOyB9XHJcbiAgICB0eXBlIHU4ICAgICA9IG51bWJlciAmIHsgX25vdF9yZWFsOiBcInU4XCI7IH1cclxuICAgIHR5cGUgdTE2ICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidTE2XCI7IH1cclxuICAgIHR5cGUgdTMyICAgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidTMyXCI7IH1cclxuICAgIHR5cGUgdXNpemUgID0gbnVtYmVyICYgeyBfbm90X3JlYWw6IFwidXNpemVcIjsgfVxyXG5cclxuICAgIGNvbnN0IHthdG9taWNfc2FiLCBzdGRpbl9zYWJ9ID0gZGF0YTtcclxuICAgIGNvbnN0IGF0b21pYyAgICA9IG5ldyBJbnQzMkFycmF5KGF0b21pY19zYWIpO1xyXG4gICAgY29uc3Qgc3RkaW4gICAgID0gbmV3IFVpbnQ4QXJyYXkoc3RkaW5fc2FiKTtcclxuXHJcbiAgICAvLyBSZWZlcmVuY2VzOlxyXG4gICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2ktdHlwZXMvMC4xLjUvc3JjL3dhc2lfdHlwZXMvbGliLnJzLmh0bWxcclxuICAgIC8vIGh0dHBzOi8vZG9jcy5ycy93YXNpLzAuMTAuMit3YXNpLXNuYXBzaG90LXByZXZpZXcxL3NyYy93YXNpL2xpYl9nZW5lcmF0ZWQucnMuaHRtbFxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1dlYkFzc2VtYmx5L1dBU0kvYmxvYi9tYWluL3BoYXNlcy9zbmFwc2hvdC9kb2NzLm1kXHJcblxyXG4gICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzI3XHJcbiAgICBjb25zdCBFUlJOT19TVUNDRVNTICAgICA9IDxFcnJubz4wO1xyXG4gICAgY29uc3QgRVJSTk9fQkFERiAgICAgICAgPSA8RXJybm8+ODtcclxuICAgIGNvbnN0IEVSUk5PX05PVENBUEFCTEUgID0gPEVycm5vPjc2O1xyXG5cclxuICAgIGZ1bmN0aW9uIHJlYWRfdTgoICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogdTggICAgICAgeyByZXR1cm4gbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLmdldFVpbnQ4KCBwdHIgKyBvZmZzZXQgICAgICApIGFzIHU4OyB9XHJcbiAgICBmdW5jdGlvbiByZWFkX3UxNiggIHB0cjogcHRyLCBvZmZzZXQ6IG51bWJlcik6IHUxNiAgICAgIHsgcmV0dXJuIG5ldyBEYXRhVmlldyhtZW1vcnkuYnVmZmVyKS5nZXRVaW50MTYocHRyICsgb2Zmc2V0LCB0cnVlKSBhcyB1MTY7IH1cclxuICAgIGZ1bmN0aW9uIHJlYWRfdTMyKCAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogdTMyICAgICAgeyByZXR1cm4gbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLmdldFVpbnQzMihwdHIgKyBvZmZzZXQsIHRydWUpIGFzIHUzMjsgfVxyXG4gICAgZnVuY3Rpb24gcmVhZF91c2l6ZShwdHI6IHB0ciwgb2Zmc2V0OiBudW1iZXIpOiB1c2l6ZSAgICB7IHJldHVybiByZWFkX3UzMiggIHB0ciwgb2Zmc2V0KSBhcyBhbnk7IH1cclxuICAgIGZ1bmN0aW9uIHJlYWRfcHRyKCAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyKTogcHRyICAgICAgeyByZXR1cm4gcmVhZF91c2l6ZShwdHIsIG9mZnNldCkgYXMgYW55OyB9XHJcblxyXG4gICAgZnVuY3Rpb24gd3JpdGVfdTgoICAgICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogdTggICAgICkgeyBuZXcgRGF0YVZpZXcobWVtb3J5LmJ1ZmZlcikuc2V0VWludDgoIHB0ciArIG9mZnNldCwgdmFsdWUgICAgICApOyB9XHJcbiAgICBmdW5jdGlvbiB3cml0ZV91MTYoICAgICBwdHI6IHB0ciwgb2Zmc2V0OiBudW1iZXIsIHZhbHVlOiB1MTYgICAgKSB7IG5ldyBEYXRhVmlldyhtZW1vcnkuYnVmZmVyKS5zZXRVaW50MTYocHRyICsgb2Zmc2V0LCB2YWx1ZSwgdHJ1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHdyaXRlX3UzMiggICAgIHB0cjogcHRyLCBvZmZzZXQ6IG51bWJlciwgdmFsdWU6IHUzMiAgICApIHsgbmV3IERhdGFWaWV3KG1lbW9yeS5idWZmZXIpLnNldFVpbnQzMihwdHIgKyBvZmZzZXQsIHZhbHVlLCB0cnVlKTsgfVxyXG4gICAgZnVuY3Rpb24gd3JpdGVfdXNpemUoICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogdXNpemUgICkgeyB3cml0ZV91MzIoICBwdHIsIG9mZnNldCwgdmFsdWUgYXMgYW55KTsgfVxyXG4gICAgZnVuY3Rpb24gd3JpdGVfcHRyKCAgICAgcHRyOiBwdHIsIG9mZnNldDogbnVtYmVyLCB2YWx1ZTogcHRyICAgICkgeyB3cml0ZV91c2l6ZShwdHIsIG9mZnNldCwgdmFsdWUgYXMgYW55KTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNsaWNlKHB0cjogcHRyLCBzdGFydDogdXNpemUsIGVuZDogdXNpemUpOiBEYXRhVmlldyB7IHJldHVybiBuZXcgRGF0YVZpZXcobWVtb3J5LmJ1ZmZlciwgcHRyK3N0YXJ0LCBlbmQtc3RhcnQpOyB9XHJcblxyXG4gICAgZnVuY3Rpb24gbnlpKCk6IEVycm5vIHtcclxuICAgICAgICAvL2RlYnVnZ2VyO1xyXG4gICAgICAgIHJldHVybiBFUlJOT19OT1RDQVBBQkxFO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHdvcmsyZG9tKG1lc3NhZ2U6IFdvcmtlclRvRG9tRGF0YSkge1xyXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9EZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZS9wb3N0TWVzc2FnZSBub3RcclxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2luZG93L3Bvc3RNZXNzYWdlXHJcbiAgICAgICAgKHNlbGYgYXMgYW55KS5wb3N0TWVzc2FnZShtZXNzYWdlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhcmdzX2dldCAgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGFyZ3Nfc2l6ZXNfZ2V0ICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZW52aXJvbl9nZXQgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBlbnZpcm9uX3NpemVzX2dldCAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGNsb2NrX3Jlc19nZXQgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gY2xvY2tfdGltZV9nZXQgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9hZHZpc2UgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2FsbG9jYXRlICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfY2xvc2UgICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9kYXRhc3luYyAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2Zkc3RhdF9nZXQgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfZmRzdGF0X3NldF9mbGFncyAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9mZHN0YXRfc2V0X3JpZ2h0cyAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX2ZpbGVzdGF0X2dldCAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfZmlsZXN0YXRfc2V0X3NpemUgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9maWxlc3RhdF9zZXRfdGltZXMgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3ByZWFkICAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfcHJlc3RhdF9nZXQgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9wcmVzdGF0X2Rpcl9uYW1lICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3B3cml0ZSAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZkX3JlYWQoZmQ6IEZkLCBpb3ZlY19hcnJheV9wdHI6IHB0ciwgaW92ZWNfYXJyYXlfbGVuOiB1c2l6ZSwgbnJlYWRfcHRyOiBwdHIpOiBFcnJubyB7XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzE3NTRcclxuXHJcbiAgICAgICAgdmFyIG5yZWFkID0gMDtcclxuICAgICAgICB2YXIgZXJybm8gPSBFUlJOT19TVUNDRVNTO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpb3ZlY19pZHggPSAwOyBpb3ZlY19pZHggPCBpb3ZlY19hcnJheV9sZW47ICsraW92ZWNfaWR4KSB7XHJcbiAgICAgICAgICAgIHZhciBidWZfcHRyID0gcmVhZF9wdHIoaW92ZWNfYXJyYXlfcHRyLCA4ICogaW92ZWNfaWR4ICsgMCk7XHJcbiAgICAgICAgICAgIHZhciBidWZfbGVuID0gcmVhZF91c2l6ZShpb3ZlY19hcnJheV9wdHIsIDggKiBpb3ZlY19pZHggKyA0KTtcclxuICAgICAgICAgICAgaWYgKGJ1Zl9sZW4gPD0gMCkgeyBjb250aW51ZTsgfVxyXG5cclxuICAgICAgICAgICAgc3dpdGNoIChmZCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiAvLyBzdGRpblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoOzspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnN1bWVkICAgID0gQXRvbWljcy5sb2FkKGF0b21pYywgQVRPTUlDX1NURElOX0NPTlNVTUVEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKEF0b21pY3Mud2FpdChhdG9taWMsIEFUT01JQ19TVERJTl9GSUxMRUQsIGNvbnN1bWVkKSAhPT0gXCJva1wiKSB7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsbGVkICAgICAgPSBBdG9taWNzLmxvYWQoYXRvbWljLCBBVE9NSUNfU1RESU5fRklMTEVEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF2YWlsYWJsZSAgID0gKGZpbGxlZC1jb25zdW1lZCl8MDsgLy8gYXZhaWxhYmxlICp0byByZWFkKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmFzc2VydChhdmFpbGFibGUgPiAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBNYXRoLm1pbihhdmFpbGFibGUsIGJ1Zl9sZW4pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPG47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBzdGRpblsoaStjb25zdW1lZCkmU1RESU5fTUFTS10gYXMgdTg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrMmRvbSh7IGtpbmQ6IFwiY29uc29sZVwiLCB0ZXh0OiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2JdKSkgfSk7IC8vIFhYWDogbG9jYWwgZWNob1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVfdTgoYnVmX3B0ciwgaSwgYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgQXRvbWljcy5zdG9yZShhdG9taWMsIEFUT01JQ19TVERJTl9DT05TVU1FRCwgKGNvbnN1bWVkK24pfDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbnJlYWQgKz0gbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBlcnJubyA9IEVSUk5PX0JBREY7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdyaXRlX3VzaXplKG5yZWFkX3B0ciwgMCwgbnJlYWQgYXMgdXNpemUpO1xyXG4gICAgICAgIHJldHVybiBlcnJubztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmZF9yZWFkZGlyICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3JlbnVtYmVyICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gZmRfc2VlayAgICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBmZF9zeW5jICAgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIGZkX3RlbGwgICAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZkX3dyaXRlKGZkOiBGZCwgY2lvdmVjX2FycmF5X3B0cjogcHRyLCBjaW92ZWNfYXJyYXlfbGVuOiB1c2l6ZSwgbndyaXR0ZW5fcHRyOiBwdHIpOiBFcnJubyB7XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzE3OTZcclxuICAgICAgICAvLyBodHRwczovL25vZGVqcy5vcmcvYXBpL3dhc2kuaHRtbFxyXG5cclxuICAgICAgICB2YXIgbndyaXR0ZW4gPSAwO1xyXG4gICAgICAgIHZhciBlcnJubyA9IEVSUk5PX1NVQ0NFU1M7XHJcblxyXG4gICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcclxuICAgICAgICBmb3IgKHZhciBjaW92ZWNfaWR4ID0gMDsgY2lvdmVjX2lkeCA8IGNpb3ZlY19hcnJheV9sZW47ICsrY2lvdmVjX2lkeCkge1xyXG4gICAgICAgICAgICB2YXIgYnVmX3B0ciA9IHJlYWRfcHRyKGNpb3ZlY19hcnJheV9wdHIsIDggKiBjaW92ZWNfaWR4ICsgMCk7XHJcbiAgICAgICAgICAgIHZhciBidWZfbGVuID0gcmVhZF91c2l6ZShjaW92ZWNfYXJyYXlfcHRyLCA4ICogY2lvdmVjX2lkeCArIDQpO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoIChmZCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiAvLyBzdGRvdXRcclxuICAgICAgICAgICAgICAgIGNhc2UgMjogLy8gc3RkZXJyXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoc2xpY2UoYnVmX3B0ciwgMCBhcyB1c2l6ZSwgYnVmX2xlbikpO1xyXG4gICAgICAgICAgICAgICAgICAgIG53cml0dGVuICs9IGJ1Zl9sZW47XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGVycm5vID0gRVJSTk9fQkFERjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRleHQgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgd29yazJkb20oeyBraW5kOiBcImNvbnNvbGVcIiwgdGV4dCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdyaXRlX3VzaXplKG53cml0dGVuX3B0ciwgMCwgbndyaXR0ZW4gYXMgdXNpemUpO1xyXG4gICAgICAgIHJldHVybiBlcnJubztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYXRoX2NyZWF0ZV9kaXJlY3RvcnkgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfZmlsZXN0YXRzX2dldCAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9maWxlc3RhdF9zZXRfdGltZXMgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX2xpbmsgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfb3BlbiAgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9yZWFkbGluayAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX3JlbW92ZV9kaXJlY3RvcnkgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBhdGhfcmVuYW1lICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gcGF0aF9zeW1saW5rICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBwYXRoX3VubGlua19maWxlICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHBvbGxfb25lb2ZmICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHByb2NfZXhpdChjb2RlOiBudW1iZXIpOiBuZXZlciB7XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnJzL3dhc2kvMC4xMC4yK3dhc2ktc25hcHNob3QtcHJldmlldzEvc3JjL3dhc2kvbGliX2dlbmVyYXRlZC5ycy5odG1sIzE5MDFcclxuICAgICAgICB3b3JrMmRvbSh7IGtpbmQ6IFwicHJvY19leGl0XCIsIGNvZGUgfSk7XHJcbiAgICAgICAgdGhyb3cgXCJleGl0XCI7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcHJvY19yYWlzZSAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBzY2hlZF95aWVsZCAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHJhbmRvbV9nZXQgICAgICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG4gICAgZnVuY3Rpb24gc29ja19yZWN2ICAgICAgICAgICAgICAgICAgKCk6IEVycm5vIHsgcmV0dXJuIG55aSgpOyB9XHJcbiAgICBmdW5jdGlvbiBzb2NrX3NlbmQgICAgICAgICAgICAgICAgICAoKTogRXJybm8geyByZXR1cm4gbnlpKCk7IH1cclxuICAgIGZ1bmN0aW9uIHNvY2tfc2h1dGRvd24gICAgICAgICAgICAgICgpOiBFcnJubyB7IHJldHVybiBueWkoKTsgfVxyXG5cclxuICAgIGNvbnN0IGltcG9ydHMgPSB7XHJcbiAgICAgICAgd2FzaV9zbmFwc2hvdF9wcmV2aWV3MToge1xyXG4gICAgICAgICAgICBhcmdzX2dldCxcclxuICAgICAgICAgICAgYXJnc19zaXplc19nZXQsXHJcbiAgICAgICAgICAgIGVudmlyb25fZ2V0LFxyXG4gICAgICAgICAgICBlbnZpcm9uX3NpemVzX2dldCxcclxuICAgICAgICAgICAgY2xvY2tfcmVzX2dldCxcclxuICAgICAgICAgICAgY2xvY2tfdGltZV9nZXQsXHJcbiAgICAgICAgICAgIGZkX2FkdmlzZSxcclxuICAgICAgICAgICAgZmRfYWxsb2NhdGUsXHJcbiAgICAgICAgICAgIGZkX2Nsb3NlLFxyXG4gICAgICAgICAgICBmZF9kYXRhc3luYyxcclxuICAgICAgICAgICAgZmRfZmRzdGF0X2dldCxcclxuICAgICAgICAgICAgZmRfZmRzdGF0X3NldF9mbGFncyxcclxuICAgICAgICAgICAgZmRfZmRzdGF0X3NldF9yaWdodHMsXHJcbiAgICAgICAgICAgIGZkX2ZpbGVzdGF0X2dldCxcclxuICAgICAgICAgICAgZmRfZmlsZXN0YXRfc2V0X3NpemUsXHJcbiAgICAgICAgICAgIGZkX2ZpbGVzdGF0X3NldF90aW1lcyxcclxuICAgICAgICAgICAgZmRfcHJlYWQsXHJcbiAgICAgICAgICAgIGZkX3ByZXN0YXRfZ2V0LFxyXG4gICAgICAgICAgICBmZF9wcmVzdGF0X2Rpcl9uYW1lLFxyXG4gICAgICAgICAgICBmZF9wd3JpdGUsXHJcbiAgICAgICAgICAgIGZkX3JlYWQsXHJcbiAgICAgICAgICAgIGZkX3JlYWRkaXIsXHJcbiAgICAgICAgICAgIGZkX3JlbnVtYmVyLFxyXG4gICAgICAgICAgICBmZF9zZWVrLFxyXG4gICAgICAgICAgICBmZF9zeW5jLFxyXG4gICAgICAgICAgICBmZF90ZWxsLFxyXG4gICAgICAgICAgICBmZF93cml0ZSxcclxuICAgICAgICAgICAgcGF0aF9jcmVhdGVfZGlyZWN0b3J5LFxyXG4gICAgICAgICAgICBwYXRoX2ZpbGVzdGF0c19nZXQsXHJcbiAgICAgICAgICAgIHBhdGhfZmlsZXN0YXRfc2V0X3RpbWVzLFxyXG4gICAgICAgICAgICBwYXRoX2xpbmssXHJcbiAgICAgICAgICAgIHBhdGhfb3BlbixcclxuICAgICAgICAgICAgcGF0aF9yZWFkbGluayxcclxuICAgICAgICAgICAgcGF0aF9yZW1vdmVfZGlyZWN0b3J5LFxyXG4gICAgICAgICAgICBwYXRoX3JlbmFtZSxcclxuICAgICAgICAgICAgcGF0aF9zeW1saW5rLFxyXG4gICAgICAgICAgICBwYXRoX3VubGlua19maWxlLFxyXG4gICAgICAgICAgICBwb2xsX29uZW9mZixcclxuICAgICAgICAgICAgcHJvY19leGl0LFxyXG4gICAgICAgICAgICBwcm9jX3JhaXNlLFxyXG4gICAgICAgICAgICBzY2hlZF95aWVsZCxcclxuICAgICAgICAgICAgcmFuZG9tX2dldCxcclxuICAgICAgICAgICAgc29ja19yZWN2LFxyXG4gICAgICAgICAgICBzb2NrX3NlbmQsXHJcbiAgICAgICAgICAgIHNvY2tfc2h1dGRvd24sXHJcbiAgICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgYmluYXJ5ID0gYXRvYih3YXNtKTtcclxuICAgIGNvbnN0IHR5cGVkYXJyYXkgPSBuZXcgVWludDhBcnJheShiaW5hcnkubGVuZ3RoKTtcclxuICAgIGZvciAodmFyIGk9MDsgaTxiaW5hcnkubGVuZ3RoOyArK2kpIHsgdHlwZWRhcnJheVtpXSA9IGJpbmFyeS5jaGFyQ29kZUF0KGkpOyB9XHJcblxyXG4gICAgV2ViQXNzZW1ibHkuY29tcGlsZSh0eXBlZGFycmF5KS50aGVuKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgaWYgKGZhbHNlKSB7XHJcbiAgICAgICAgICAgIFdlYkFzc2VtYmx5Lk1vZHVsZS5pbXBvcnRzKG0pLmZvckVhY2goZnVuY3Rpb24gKGltcCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbXBvcnRcIiwgaW1wKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFdlYkFzc2VtYmx5Lk1vZHVsZS5leHBvcnRzKG0pLmZvckVhY2goZnVuY3Rpb24gKGV4cCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJleHBvcnRcIiwgZXhwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZShtLCBpbXBvcnRzKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICBtZW1vcnkgPSA8YW55Pm0uZXhwb3J0cy5tZW1vcnk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgKG0uZXhwb3J0cy5tYWluIGFzIGFueSkoKTtcclxuICAgICAgICAgICAgcHJvY19leGl0KDApO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUgIT09IFwiZXhpdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbiIsImludGVyZmFjZSBDb25zb2xlRXZlbnREYXRhIHtcclxuICAgIGtpbmQ6ICAgXCJjb25zb2xlXCI7XHJcbiAgICB0ZXh0OiAgIHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFByb2NFeGl0RXZlbnREYXRhIHtcclxuICAgIGtpbmQ6ICAgXCJwcm9jX2V4aXRcIjtcclxuICAgIGNvZGU6ICAgbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgT3RoZXJFdmVudERhdGEge1xyXG4gICAga2luZDogICBcIl9vdGhlclwiO1xyXG59XHJcblxyXG50eXBlIFdvcmtlclRvRG9tRGF0YSA9IENvbnNvbGVFdmVudERhdGEgfCBQcm9jRXhpdEV2ZW50RGF0YSB8IE90aGVyRXZlbnREYXRhXHJcblxyXG5pbnRlcmZhY2UgV29ya2VyVG9Eb21NZXNzYWdlIGV4dGVuZHMgTWVzc2FnZUV2ZW50IHtcclxuICAgIHJlYWRvbmx5IGRhdGE6IFdvcmtlclRvRG9tRGF0YTtcclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBkb20yd29yayhkYXRhOiBEb21Ub1dvcmtlckRhdGEpIHtcclxuICAgIG1haW5fZG9tX3dvcmtlci5wb3N0TWVzc2FnZShkYXRhKTtcclxufVxyXG5cclxudmFyIG1haW5fZG9tX3dvcmtlciA6IFdvcmtlcjtcclxuZnVuY3Rpb24gbWFpbl9kb20oKSB7XHJcbiAgICBjb25zdCBjb24gICAgICAgPSByZXF1aXJlRWxlbWVudEJ5SWQoXCJjb25zb2xlXCIpO1xyXG4gICAgY29uc3QgY3Vyc29yICAgID0gcmVxdWlyZUVsZW1lbnRCeUlkKFwiY3Vyc29yXCIpO1xyXG5cclxuICAgIGNvbnN0IGF0b21pY19zYWIgICAgPSBuZXcgU2hhcmVkQXJyYXlCdWZmZXIoNCAqIEFUT01JQ19DT1VOVCk7XHJcbiAgICBjb25zdCBhdG9taWMgICAgICAgID0gbmV3IEludDMyQXJyYXkoYXRvbWljX3NhYik7XHJcbiAgICBjb25zdCBzdGRpbl9zYWIgICAgID0gbmV3IFNoYXJlZEFycmF5QnVmZmVyKFNURElOX0NPVU5UKTtcclxuICAgIGNvbnN0IHN0ZGluICAgICAgICAgPSBuZXcgVWludDhBcnJheShzdGRpbl9zYWIpO1xyXG5cclxuICAgIC8vIHNwYXduIHdlYiB3b3JrZXJcclxuICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYig8QmxvYlBhcnRbXT5BcnJheS5wcm90b3R5cGUubWFwLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0Om5vdChbZGF0YS1qcy13b3JrZXI9XFwnZmFsc2VcXCddKScpLCBmdW5jdGlvbiAob1NjcmlwdCkgeyByZXR1cm4gb1NjcmlwdC50ZXh0Q29udGVudDsgfSkse3R5cGU6ICd0ZXh0L2phdmFzY3JpcHQnfSk7XHJcbiAgICBtYWluX2RvbV93b3JrZXIgPSBuZXcgV29ya2VyKHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpKTtcclxuICAgIG1haW5fZG9tX3dvcmtlci5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlOiBXb3JrZXJUb0RvbU1lc3NhZ2UpIHtcclxuICAgICAgICBzd2l0Y2ggKGUuZGF0YS5raW5kKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJjb25zb2xlXCI6XHJcbiAgICAgICAgICAgICAgICBjb24uaW5zZXJ0QmVmb3JlKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGUuZGF0YS50ZXh0KSwgY3Vyc29yKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwicHJvY19leGl0XCI6XHJcbiAgICAgICAgICAgICAgICB2YXIgZXhpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgICAgICAgICAgZXhpdC50ZXh0Q29udGVudCA9IGBcXG5wcm9jZXNzIGV4aXRlZCB3aXRoIGNvZGUgJHtlLmRhdGEuY29kZX1gO1xyXG4gICAgICAgICAgICAgICAgZXhpdC5zdHlsZS5jb2xvciA9IFwiIzg4OFwiO1xyXG4gICAgICAgICAgICAgICAgY29uLmluc2VydEJlZm9yZShleGl0LCBjdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgY29uLnJlbW92ZUNoaWxkKGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJ1bmV4cGVjdGVkIGV2ZW50IGtpbmRcIiwgZS5kYXRhLmtpbmQpO1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZG9tMndvcmsoe1xyXG4gICAgICAgIGtpbmQ6IFwiaW5pdFwiLFxyXG4gICAgICAgIGF0b21pY19zYWIsXHJcbiAgICAgICAgc3RkaW5fc2FiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHN0ZGluX2J1ZmZlciA6IG51bWJlcltdID0gW107XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHZhciB0ZXh0ID0gZS5jaGFyIHx8IFN0cmluZy5mcm9tQ2hhckNvZGUoZS5jaGFyQ29kZSk7XHJcbiAgICAgICAgaWYgKHRleHQgPT09IFwiXFxyXCIpIHsgdGV4dCA9IFwiXFxuXCI7IH1cclxuICAgICAgICB2YXIgY2hhcnMgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUodGV4dCk7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpPGNoYXJzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHN0ZGluX2J1ZmZlci5wdXNoKGNoYXJzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmIChzdGRpbl9idWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBmaWxsZWQgICAgICA9IEF0b21pY3MubG9hZChhdG9taWMsIEFUT01JQ19TVERJTl9GSUxMRUQpO1xyXG4gICAgICAgIHZhciBjb25zdW1lZCAgICA9IEF0b21pY3MubG9hZChhdG9taWMsIEFUT01JQ19TVERJTl9DT05TVU1FRCk7XHJcbiAgICAgICAgdmFyIGF2YWlsYWJsZSAgID0gU1RESU5fQ09VTlQgLSAoKGZpbGxlZC1jb25zdW1lZCl8MCk7IC8vIGF2YWlsYWJsZSAqdG8gd3JpdGUqXHJcblxyXG4gICAgICAgIHZhciBuID0gTWF0aC5taW4oYXZhaWxhYmxlLCBzdGRpbl9idWZmZXIubGVuZ3RoKTtcclxuICAgICAgICBmb3IgKHZhciBpPTA7IGk8bjsgKytpKSB7XHJcbiAgICAgICAgICAgIHN0ZGluWyhpK2ZpbGxlZCkmU1RESU5fTUFTS10gPSBzdGRpbl9idWZmZXJbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0ZGluX2J1ZmZlci5zcGxpY2UoMCwgbik7XHJcbiAgICAgICAgZmlsbGVkID0gKGZpbGxlZCtuKXwwO1xyXG4gICAgICAgIEF0b21pY3Muc3RvcmUoYXRvbWljLCBBVE9NSUNfU1RESU5fRklMTEVELCBmaWxsZWQpO1xyXG4gICAgICAgIEF0b21pY3Mubm90aWZ5KGF0b21pYywgQVRPTUlDX1NURElOX0ZJTExFRCwgK0luZmluaXR5KTtcclxuICAgIH0sIDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXF1aXJlRWxlbWVudEJ5SWQoaWQ6IHN0cmluZyk6IEhUTUxFbGVtZW50IHtcclxuICAgIGxldCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgIGlmICghZWwpIHsgdGhyb3cgYG5vIHN1Y2ggZWxlbWVudCBpbiBkb2N1bWVudDogIyR7aWR9YDsgfVxyXG4gICAgcmV0dXJuIGVsO1xyXG59XHJcbiIsImludGVyZmFjZSBJbml0RXZlbnREYXRhIHtcclxuICAgIGtpbmQ6IFwiaW5pdFwiO1xyXG4gICAgYXRvbWljX3NhYjogU2hhcmVkQXJyYXlCdWZmZXIsXHJcbiAgICBzdGRpbl9zYWI6ICBTaGFyZWRBcnJheUJ1ZmZlcixcclxufVxyXG5cclxuaW50ZXJmYWNlIE90aGVyRXZlbnREYXRhIHtcclxuICAgIGtpbmQ6IFwiX290aGVyXCI7XHJcbn1cclxuXHJcbnR5cGUgRG9tVG9Xb3JrZXJEYXRhID0gSW5pdEV2ZW50RGF0YSB8IE90aGVyRXZlbnREYXRhO1xyXG5cclxuaW50ZXJmYWNlIFdvcmtlck1lc3NhZ2VFdmVudCBleHRlbmRzIE1lc3NhZ2VFdmVudCB7XHJcbiAgICByZWFkb25seSBkYXRhOiBEb21Ub1dvcmtlckRhdGE7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1haW5fd29ya2VyKCkge1xyXG4gICAgc2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlOiBXb3JrZXJNZXNzYWdlRXZlbnQpIHtcclxuICAgICAgICBzd2l0Y2ggKGUuZGF0YS5raW5kKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJpbml0XCI6XHJcbiAgICAgICAgICAgICAgICBleGVjX2Jhc2U2NF93YXNtKGUuZGF0YSwgXCJ7QkFTRTY0X1dBU00zMn1cIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJ1bmV4cGVjdGVkIGV2ZW50IGtpbmRcIiwgZS5kYXRhLmtpbmQpO1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbiJdfQ==